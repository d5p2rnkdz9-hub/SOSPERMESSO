---
pagination:
  data: documents.rinnovo
  size: 1
  alias: doc
permalink: "documenti-{{ doc.slug }}-rinnovo.html"
layout: false
eleventyExcludeFromCollections: true
---
<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Documenti necessari per il rinnovo del permesso per {{ doc.tipo }}">
  <title>Documenti {{ doc.tipo }} - Rinnovo - SOS Permesso</title>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="IMAGES/Favicon.svg">
  <link rel="shortcut icon" type="image/svg+xml" href="IMAGES/Favicon.svg">
  <link rel="apple-touch-icon" href="IMAGES/Favicon.svg">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="src/styles/main.css">
  <link rel="stylesheet" href="src/styles/components.css">
  <link rel="stylesheet" href="src/styles/animations.css">
  <link rel="stylesheet" href="src/styles/mobile.css">
  <link rel="stylesheet" href="src/styles/mobile-fix.css">
  <link rel="stylesheet" href="src/styles/document-page.css">
  <link rel="stylesheet" href="src/styles/prassi.css">
</head>
<body class="page-rinnovo">

  {% include "components/header.liquid" %}

  <!-- BREADCRUMB -->
  <section class="section" style="padding: 1rem 0;">
    <div class="container" style="position: relative;">
      <div style="font-size: 0.875rem; color: var(--gray-medium);">
        <a href="index.html" style="color: var(--taxi-yellow-dark);">Home</a> ‚Üí
        <a href="documenti-questura.html" style="color: var(--taxi-yellow-dark);">Documenti Questura</a> ‚Üí
        <span>{{ doc.tipo }} - Rinnovo</span>
      </div>
    </div>
  </section>

  <!-- PAGE HEADER -->
  <section class="section bg-off-white" style="padding: 1.5rem 0;">
    <div class="container">
      <div class="page-header text-center">
        <h1 class="page-title" style="margin-bottom: 0.25rem;">{{ doc.tipo }}</h1>
        <p class="section-subtitle" style="margin-bottom: 0.5rem;">Documenti per il <strong>Rinnovo</strong></p>
        <a href="documenti-{{ doc.slug }}-primo.html" class="quick-switch-link">
          Vedi anche: Primo Rilascio ‚Üí
        </a>
        <a href="permesso-{{ doc.slug }}.html" class="costi-anchor-link">
          Vedi il permesso
        </a>
        <a href="#prassi-locali" class="prassi-anchor-link">
          Prassi locali della tua Questura
        </a>
      </div>
    </div>
  </section>

  <!-- SUBMISSION METHOD CALLOUT -->
  {%- assign methodLower = doc.method | downcase -%}
  {%- if methodLower contains 'kit' -%}
    {%- assign calloutClass = 'callout-kit' -%}
    {%- assign calloutIcon = 'üìÆ' -%}
    {%- assign calloutText = 'Invia tramite KIT alle Poste (non devi andare in Questura)' -%}
  {%- else -%}
    {%- assign calloutClass = 'callout-questura' -%}
    {%- assign calloutIcon = 'üèõÔ∏è' -%}
    {%- assign calloutText = 'Porta i documenti in Questura (non puoi usare il KIT postale)' -%}
  {%- endif -%}
  <section class="section" style="padding: 1rem 0;">
    <div class="container" style="max-width: 700px;">
      <div class="submission-callout {{ calloutClass }}">
        <span class="callout-icon">{{ calloutIcon }}</span>
        <div class="callout-text">{{ calloutText }}</div>
      </div>
    </div>
  </section>

  {%- if doc.slug contains 'attesa-occupazione' -%}
  <!-- DISPUTED RENEWAL WARNING -->
  <section class="section" style="padding: 0.5rem 0;">
    <div class="container" style="max-width: 700px;">
      <div class="alert alert-danger" style="background: #FFF0F0; border: 1.5px solid #E53935; border-radius: 8px;">
        <span class="alert-icon">‚ö†Ô∏è</span>
        <div>
          <strong>Attenzione:</strong> Il rinnovo del permesso per attesa occupazione √® controverso. Alcune Questure lo negano. Ti consigliamo di rivolgerti a un avvocato o sportello legale prima di procedere.
          <br><br>
          <a href="aiuto-legale.html" style="color: #E53935; font-weight: 600;">‚Üí Trova aiuto legale nella tua zona</a>
        </div>
      </div>
    </div>
  </section>
  {%- endif -%}

  <!-- DOCUMENT CHECKLIST -->
  <section class="section">
    <div class="container" style="max-width: 700px;">
      <div class="card">
        <h2>üìã Documenti necessari</h2>
        <p class="checklist-intro">Spunta i documenti che hai gi√† preparato. I tuoi progressi vengono salvati automaticamente.</p>

        {%- assign commonDocName = "Copia permesso precedente (o denuncia smarrimento)" -%}
        {%- assign commonDocNormalized = commonDocName | normalizeDocumentName -%}
        {%- assign commonDocClass = commonDocNormalized | getDocumentClass -%}
        {%- assign commonDocLabel = commonDocNormalized | linkToDizionario -%}

        <div class="doc-checklist" data-permit="{{ doc.slug }}-rinnovo">
          <!-- Common document always first -->
          <div class="{{ commonDocClass }}">
            <input type="checkbox"
                   class="doc-checkbox"
                   id="doc-{{ doc.slug }}-rinnovo-0"
                   data-doc="{{ commonDocNormalized | escapeHtml }}">
            <span class="doc-label">{{ commonDocLabel }}</span>
          </div>

          <!-- Remaining documents (skip if duplicate of common doc) -->
          {%- for docItem in doc.documents -%}
            {%- assign normalizedDoc = docItem | normalizeDocumentName -%}
            {%- assign lowerDoc = normalizedDoc | downcase -%}
            {%- unless lowerDoc contains "copia permesso precedente" -%}
              {%- assign docClass = normalizedDoc | getDocumentClass -%}
              {%- assign docLabel = normalizedDoc | linkToDizionario -%}
              {%- assign disputed = normalizedDoc | isDisputed -%}
              {%- assign idx = forloop.index -%}
          <div class="{{ docClass }}">
            <input type="checkbox"
                   class="doc-checkbox"
                   id="doc-{{ doc.slug }}-rinnovo-{{ idx }}"
                   data-doc="{{ normalizedDoc | escapeHtml }}">
            <span class="doc-label">{{ docLabel }}{% if disputed %}<span class="disputed-note">(potrebbe dipendere dalla Questura)</span>{% endif %}</span>
          </div>
            {%- endunless -%}
          {%- endfor -%}
        </div>

        {%- assign totalDocs = doc.documents.size | plus: 1 -%}
        <div class="checklist-progress">
          <span class="progress-text">Completati: <span id="progress-count">0</span>/{{ totalDocs }}</span>
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
          </div>
        </div>
      </div>

      <div class="alert alert-warning" style="margin-top: 1rem;">
        <span class="alert-icon">‚ö†Ô∏è</span>
        <div>
          <strong>Nota:</strong> I documenti richiesti possono variare da Questura a Questura. Contatta sempre la tua Questura per confermare la lista esatta.
        </div>
      </div>

      <div class="alert alert-info" style="margin-top: 0.75rem;">
        <span class="alert-icon">üìÖ</span>
        <div>
          <strong>Ricorda:</strong> La richiesta di rinnovo va presentata preferibilmente <strong>prima della scadenza</strong> o comunque <strong>entro 60 giorni</strong> dalla scadenza.
        </div>
      </div>
    </div>
  </section>

  {%- assign notesSections = doc.docNotes | parseDocNotes -%}
  {%- if notesSections.size > 0 -%}
  <!-- DOCUMENT NOTES -->
  <section class="section bg-off-white">
    <div class="container" style="max-width: 700px;">
      <h2 style="text-align: center; margin-bottom: 1.5rem;">üìù Informazioni aggiuntive sui documenti</h2>
      {%- for section in notesSections -%}
      <div class="card" style="margin-bottom: 1rem;">
        <h3 style="margin-bottom: 0.75rem; font-size: 1rem;">{{ section.question | escapeHtml }}</h3>
        {{ section.content }}
      </div>
      {%- endfor -%}
    </div>
  </section>
  {%- endif -%}

  {%- if doc.costBollettino or doc.costMarcaBollo -%}
  <!-- COSTI -->
  <section class="section bg-off-white" id="quanto-costa">
    <div class="container" style="max-width: 700px;">
      <h2 style="text-align: center; margin-bottom: 1.5rem;">üí∞ Quanto costa?</h2>
      <div class="card">
        <ul class="costi-list">
          {%- if doc.costBollettino -%}
          <li class="costi-item">
            <span class="costi-label">Bollettino postale <span class="costi-note">da pagare alle Poste</span></span>
            <span class="costi-amount">‚Ç¨ {{ doc.costBollettino }}</span>
          </li>
          {%- endif -%}
          {%- if doc.costMarcaBollo -%}
          <li class="costi-item">
            <span class="costi-label">Marca da bollo <span class="costi-note">da comprare in tabaccheria</span></span>
            <span class="costi-amount">‚Ç¨ {{ doc.costMarcaBollo }}</span>
          </li>
          {%- endif -%}
          {%- assign methodLowerCosti = doc.method | downcase -%}
          {%- if methodLowerCosti contains 'kit' -%}
          <li class="costi-item">
            <span class="costi-label">Kit postale <span class="costi-note">da comprare alle Poste</span></span>
            <span class="costi-amount">‚Ç¨ 30,00</span>
          </li>
          {%- endif -%}
        </ul>
        <div class="costi-total">
          <span class="costi-total-label">Totale</span>
          <span class="costi-total-amount">‚Ç¨
            {%- assign total = 0 -%}
            {%- if doc.costBollettino -%}{%- assign total = total | plus: doc.costBollettino -%}{%- endif -%}
            {%- if doc.costMarcaBollo -%}{%- assign total = total | plus: doc.costMarcaBollo -%}{%- endif -%}
            {%- assign methodLowerTotal = doc.method | downcase -%}
            {%- if methodLowerTotal contains 'kit' -%}{%- assign total = total | plus: 30 -%}{%- endif -%}
            {{ total }}
          </span>
        </div>
      </div>
    </div>
  </section>
  {%- endif -%}

  <!-- PRASSI LOCALI -->
  <section class="section prassi-section" id="prassi-locali">
    <div class="container" style="max-width: 700px;">
      <h2 style="text-align: center; margin-bottom: 0.5rem;">Prassi locali</h2>
      <p style="text-align: center; color: var(--gray-medium); margin-bottom: 1.5rem;">Esperienze condivise dalla community sulle pratiche delle Questure</p>

      {% assign pagePrassi = prassiLocali[doc.slug] %}
      {% if pagePrassi %}
        {% for cityGroup in pagePrassi %}
          <div class="prassi-city-group">
            <h3 class="prassi-city-name">{{ cityGroup[0] }}</h3>
            {% for practice in cityGroup[1] %}
              <div class="prassi-card" data-prassi-id="{{ practice.id }}">
                <p class="prassi-card-description">{{ practice.description }}</p>
                <div class="prassi-card-meta">
                  {% if practice.date %}<span>{{ practice.date }}</span>{% endif %}
                  {% if practice.category %}<span class="prassi-category-tag">{{ practice.category }}</span>{% endif %}
                </div>
                <div class="prassi-card-votes">
                  <span class="vote-confermo">Confermo: {{ practice.votiConfermo }}</span>
                  <span class="vote-non-confermo">Non confermo: {{ practice.votiNonConfermo }}</span>
                </div>
              </div>
            {% endfor %}
          </div>
        {% endfor %}
      {% else %}
        <div class="prassi-empty-state">
          <p>Nessuna segnalazione ancora. Sei il primo a condividere la tua esperienza!</p>
          <button class="btn btn-primary prassi-submit-btn" onclick="openPrassiModal('https://sospermesso.it/documenti-{{ doc.slug }}-rinnovo.html', '{{ doc.slug }}')">
            Aggiungi la tua esperienza
          </button>
        </div>
      {% endif %}

      {% if pagePrassi %}
        <div style="text-align: center; margin-top: 1.5rem;">
          <button class="btn btn-primary prassi-submit-btn" onclick="openPrassiModal('https://sospermesso.it/documenti-{{ doc.slug }}-rinnovo.html', '{{ doc.slug }}')">
            Aggiungi la tua esperienza
          </button>
        </div>
      {% endif %}
    </div>
  </section>

  {% include "components/footer.liquid" %}

  <script src="src/scripts/app.js"></script>
  <script>
    // Checklist persistence with localStorage
    (function() {
      var permitKey = '{{ doc.slug }}-rinnovo';
      var checkboxes = document.querySelectorAll('.doc-checkbox');
      var progressCount = document.getElementById('progress-count');
      var progressFill = document.getElementById('progress-fill');

      // Load saved state
      function loadState() {
        var saved = localStorage.getItem('checklist-' + permitKey);
        if (saved) {
          try {
            var state = JSON.parse(saved);
            state.forEach(function(item) {
              var checkbox = document.getElementById(item.id);
              if (checkbox) checkbox.checked = item.checked;
            });
          } catch (e) {
            console.warn('Failed to load checklist state:', e);
          }
        }
        updateProgress();
      }

      // Save state
      function saveState() {
        var state = Array.from(checkboxes).map(function(cb) {
          return {
            id: cb.id,
            checked: cb.checked
          };
        });
        localStorage.setItem('checklist-' + permitKey, JSON.stringify(state));
        updateProgress();
      }

      // Update progress bar
      function updateProgress() {
        var total = checkboxes.length;
        var checked = Array.from(checkboxes).filter(function(cb) { return cb.checked; }).length;
        progressCount.textContent = checked;
        progressFill.style.width = (total > 0 ? (checked / total) * 100 : 0) + '%';
      }

      // Attach event listeners
      checkboxes.forEach(function(cb) { cb.addEventListener('change', saveState); });

      // Initialize
      document.addEventListener('DOMContentLoaded', loadState);
    })();
  </script>

  <!-- Prassi locali client-side functionality -->
  <script src="src/scripts/prassi.js"></script>
</body>
</html>
