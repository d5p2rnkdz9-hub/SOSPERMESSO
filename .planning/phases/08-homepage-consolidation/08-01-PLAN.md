---
phase: 08-homepage-consolidation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/index.html
  - src/pages/chi-siamo.html
autonomous: true

must_haves:
  truths:
    - "Nested homepage has same section structure as root homepage"
    - "I NOSTRI DATABASE section visible on nested homepage"
    - "AIUTO LEGALE section visible on nested homepage"
    - "Navigation from chi-siamo.html leads to root homepage"
    - "All internal links work correctly from nested homepage"
  artifacts:
    - path: "src/pages/index.html"
      provides: "Synced homepage with Phase 6 structure"
      contains: "I NOSTRI DATABASE"
    - path: "src/pages/chi-siamo.html"
      provides: "Fixed navigation links"
      contains: "../../index.html"
  key_links:
    - from: "src/pages/index.html"
      to: "database.html"
      via: "href in Database section card"
      pattern: 'href="database.html"'
    - from: "src/pages/index.html"
      to: "aiuto-legale.html"
      via: "href in Aiuto legale section"
      pattern: 'href="aiuto-legale.html"'
    - from: "src/pages/chi-siamo.html"
      to: "../../index.html"
      via: "nav menu Home link"
      pattern: 'href="../../index.html"'
---

<objective>
Sync nested homepage with root homepage Phase 6 structure and fix broken navigation.

Purpose: Eliminate content divergence between dual homepages and ensure consistent navigation.
Output: Updated src/pages/index.html with complete Phase 6 sections, fixed chi-siamo.html navigation.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-homepage-consolidation/08-RESEARCH.md

# Source files
@index.html (root - source of truth, lines 186-326 for sections)
@src/pages/index.html (target - needs update)
@src/pages/chi-siamo.html (navigation fix)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Sync nested homepage with Phase 6 structure</name>
  <files>src/pages/index.html</files>
  <action>
Replace the main content sections in src/pages/index.html to match root index.html structure.

Changes required:

1. **Update Hero section** (lines 84-104):
   - Replace old hero with new hero-new class structure
   - Use new hero title: "La Tua Guida" + "Facile" highlight + "ai Permessi di Soggiorno"
   - Add hero-subtitle, btn-hero CTA, hero-notice
   - Add decorative SVG elements (document, passport, calendar, papers, suitcase, map pin)
   - Remove lighthouse hero loading (lighthouse-hero div and fetch script)

2. **Update Tests section** (around line 107):
   - Add inline gradient style: `style="background: linear-gradient(135deg, #E8F5E9 0%, #FFF9E6 100%);"`
   - Add title color: `style="color: var(--accent-green);"`
   - Keep test cards as-is (they're already correct)

3. **ADD Database section** (NEW - insert after Tests, before Guides):
   ```html
   <!-- DATABASE SECTION -->
   <section class="section" style="background: linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 100%);">
     <div class="container">
       <div class="section-header">
         <h2 class="section-title" style="color: var(--accent-teal);">I NOSTRI DATABASE üìö</h2>
         <p class="section-subtitle">Trova rapidamente tutte le informazioni sui permessi</p>
       </div>

       <div class="grid grid-2">
         <a href="database.html" class="card card-link">
           <span class="card-icon">üìö</span>
           <h3 class="card-title">Database permessi</h3>
           <p class="card-description">Tutti i tipi di permesso disponibili in Italia</p>
         </a>

         <a href="documenti-questura.html" class="card card-link">
           <span class="card-icon">üìå</span>
           <h3 class="card-title">Documenti Questura</h3>
           <p class="card-description">Lista completa dei documenti necessari</p>
         </a>
       </div>
     </div>
   </section>
   ```

4. **Update Guides section** (reduce from 5 cards to 3):
   - Add inline gradient style: `style="background: linear-gradient(135deg, #FFF9E6 0%, #FFE0B2 100%);"`
   - Add title color: `style="color: var(--accent-orange);"`
   - REMOVE Database permessi card (moved to Database section)
   - REMOVE Documenti Questura card (moved to Database section)
   - KEEP: Protezione internazionale, Ricongiungimento familiare, Dizionario

5. **ADD Aiuto legale section** (NEW - insert after Guides, before Link utili):
   ```html
   <!-- AIUTO LEGALE SECTION -->
   <section class="section aiuto-legale-section" style="background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%);">
     <div class="container">
       <div class="section-header">
         <h2 class="section-title" style="color: var(--lighthouse-red);">AIUTO LEGALE ‚öñÔ∏è</h2>
         <p class="section-subtitle">Trova assistenza legale professionale per le tue esigenze</p>
       </div>

       <a href="aiuto-legale.html" class="card card-link aiuto-legale-card">
         <span class="card-icon">‚öñÔ∏è</span>
         <h3 class="card-title">Trova assistenza legale gratuita</h3>
         <p class="card-description">Sportelli, associazioni e avvocati che offrono consulenza gratuita per questioni di immigrazione</p>
         <button class="btn btn-secondary">TROVA AIUTO ‚Üí</button>
       </a>
     </div>
   </section>
   ```

6. **Update Link utili section** (reduce from 3 cards to 2):
   - Add inline gradient style: `style="background: linear-gradient(135deg, #FFF3E0 0%, #FFE0E6 100%);"`
   - Add title color: `style="color: var(--accent-orange);"`
   - Change grid from grid-3 to grid-2
   - REMOVE Aiuto legale card (moved to standalone section)
   - KEEP: Kit postale, Controlla permesso

7. **Update CTA section** (use modal instead of direct link):
   - Change from `<a href="https://sospermesso.typeform.com/contatti">` to `<button onclick="openContactModal()">`
   - Add contact form container: `<div id="contact-form-container"></div>`
   - Update script to load contact form: `fetch('../components/contact-form.html')`

8. **Update nav menu** (line 43-48):
   - Change "Chi siamo" link from `href="#about"` to `href="chi-siamo.html"`
   - Match root index.html nav structure

9. **Add lighthouse animation CSS** (inline styles before closing body):
   - Copy the lighthouse-container styles from root index.html (lines 344-452)

10. **Update footer links** (match root structure):
    - Ensure chi-siamo, database, contatti links present

Path notes (CRITICAL - nested context):
- All hrefs to pages: NO `src/pages/` prefix needed (e.g., `href="database.html"`)
- Contact form fetch: `fetch('../components/contact-form.html')` (note: ../ not src/)
- Images: `../../images/` prefix needed
- Styles: `../styles/` prefix already correct
  </action>
  <verify>
1. Open src/pages/index.html in browser
2. Verify 6 main sections visible: Tests, Database, Guides, Aiuto legale, Link utili, CTA
3. Verify Database section has 2 cards (Database permessi, Documenti Questura)
4. Verify Guides section has 3 cards (not 5)
5. Verify Aiuto legale section is standalone with prominent card
6. Verify Link utili has 2 cards (not 3)
7. Verify all card links work (no 404s)
8. Verify "Scrivici" button opens contact modal (not external link)
9. Count sections: should match root index.html
  </verify>
  <done>
Nested homepage has identical section structure to root homepage:
- Tests (3 cards) with green gradient
- Database (2 cards) with teal gradient
- Guides (3 cards) with orange gradient
- Aiuto legale (1 prominent card) with coral gradient
- Link utili (2 cards) with warm gradient
- CTA with contact modal integration
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix chi-siamo.html navigation links</name>
  <files>src/pages/chi-siamo.html</files>
  <action>
Fix the navigation links in chi-siamo.html that incorrectly point to nested index.html instead of root.

Changes required:

1. **Line 26** - Fix Home nav link:
   - Change: `<li><a href="index.html" class="nav-link">Home</a></li>`
   - To: `<li><a href="../../index.html" class="nav-link">Home</a></li>`

2. **Line 28** - Fix Test nav link:
   - Change: `<li><a href="index.html#test" class="nav-link">Test</a></li>`
   - To: `<li><a href="../../index.html#test" class="nav-link">Test</a></li>`

Why `../../index.html`:
- chi-siamo.html is at: /src/pages/chi-siamo.html
- Root homepage is at: /index.html
- From /src/pages/ to / requires going up two directories: ../../
  </action>
  <verify>
1. Open src/pages/chi-siamo.html in browser
2. Click "Home" nav link - should navigate to root homepage (with hero decorations)
3. Click "Test" nav link - should navigate to root homepage test section
4. Verify NOT navigating to nested homepage (which has different/outdated structure)
  </verify>
  <done>
chi-siamo.html navigation links point to root homepage:
- Home link: href="../../index.html"
- Test link: href="../../index.html#test"
  </done>
</task>

</tasks>

<verification>
After completing both tasks:

1. **Section count verification:**
   - Root index.html sections: Tests, Database, Guides, Aiuto legale, Link utili, CTA (6)
   - Nested index.html sections: Should match (6)

2. **Content parity check:**
   - grep "I NOSTRI DATABASE" both files - both should match
   - grep "AIUTO LEGALE" both files - both should match
   - grep "grid-2" Link utili section - both should have 2-column grid

3. **Navigation path audit:**
   ```bash
   grep 'href="index.html"' src/pages/*.html
   ```
   Should return NO results (all should use ../../index.html or be self-references)

4. **Link test from chi-siamo:**
   - Home link leads to root homepage with new hero
   - Test link leads to root homepage #test section
</verification>

<success_criteria>
1. src/pages/index.html has 6 content sections matching root index.html
2. "I NOSTRI DATABASE" section present with 2 cards
3. "AIUTO LEGALE" section present as standalone prominent section
4. Guides section has 3 cards (not 5)
5. Link utili section has 2 cards (not 3)
6. Contact modal integration working (not direct typeform link)
7. chi-siamo.html "Home" and "Test" links navigate to root homepage
8. All internal navigation paths consistent
</success_criteria>

<output>
After completion, create `.planning/phases/08-homepage-consolidation/08-01-SUMMARY.md`
</output>
