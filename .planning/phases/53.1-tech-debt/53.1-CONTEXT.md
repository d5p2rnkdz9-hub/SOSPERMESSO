# Phase 53.1: Tech Debt — Sitemap, Navigation & Link Fixes - Context

**Gathered:** 2026-02-19
**Status:** Ready for planning

<domain>
## Phase Boundary

Fix 7 tech debt issues that must be resolved before Phase 54 (SEO): broken sitemap generation, missing permits in listing pages, homepage canonical duplication, missing dizionario links in EN/FR, broken "Scrivici" button, missing "Contattaci" footer item, and language switcher integration into main nav.

</domain>

<decisions>
## Implementation Decisions

### database.html & documenti-questura.html gaps
- Manual fix: add the 13 missing permits to the hardcoded database.html in their correct categories
- Also audit and fix documenti-questura.html for missing document links
- Fix all three language versions (IT, EN, FR) so listings are in sync
- NOT generating dynamically — manual control preferred since some permits may still be in progress

### Sitemap rewrite
- Move from standalone `scripts/build-sitemap.js` to 11ty-native sitemap generation (template-based, part of the 11ty build)
- Scan `_site/` output (not `src/pages/`) to get correct URLs
- Homepage outputs as `/` not `/index.html`
- Exclude: `404.html`, `PREVIEW.html`, Google verification files

### Homepage canonical + redirect
- Add canonical tag + Netlify 301 redirect (`/index.html` → `/`) for all three homepages: IT, EN (`/en/`), FR (`/fr/`)
- Both canonical tag in HTML and 301 in netlify.toml

### Dizionario links in EN/FR pages
- Link all EN/FR dizionario terms back to the IT dizionario page (single source of truth)
- Match BOTH: Italian terms that appear in EN/FR text AND translated equivalents mapping to IT anchors
- Maximum coverage approach

### "Scrivici" button fix
- Fix broken Typeform link on permit page "Hai domande? Scrivici" button
- Correct URL: `https://form.typeform.com/to/G6YT01Vj`
- Apply to all permit pages across IT, EN, FR

### "Contattaci" footer item
- Add "Contattaci" item to the footer linking to `https://form.typeform.com/to/G6YT01Vj`

### Language switcher → nav menu item
- Move language switcher from standalone dropdown into the main navigation bar as a dropdown menu item
- On mobile (hamburger menu): language switcher appears at the TOP of the menu
- Supports 3 languages: IT / EN / FR

### Claude's Discretion
- Sitemap architecture: whether to keep sitemap-index (per-language sitemaps) or single sitemap
- Hreflang placement: sitemaps only, HTML head only, or both
- Dizionario term mapping file location: extend glossary or separate file
- Canonical tag audit scope: homepage only or all pages
- Language switcher dropdown visual design (labels, current language indicator)

</decisions>

<specifics>
## Specific Ideas

- "Scrivici" Typeform URL is specifically `https://form.typeform.com/to/G6YT01Vj` (confirmed by user)
- Language switcher on mobile should be the FIRST item when hamburger opens — easy to find, prominent
- Dizionario links: many Italian legal terms appear untranslated in EN/FR content, so matching Italian terms in translated text will catch a lot

</specifics>

<deferred>
## Deferred Ideas

None — discussion stayed within phase scope

</deferred>

---

*Phase: 53.1-tech-debt*
*Context gathered: 2026-02-19*
