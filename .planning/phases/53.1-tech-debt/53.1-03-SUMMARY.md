---
phase: 53.1-tech-debt
plan: 03
subsystem: ui
tags: [language-switcher, nav, mobile, liquid]

# Dependency graph
requires:
  - phase: 53-fr-page-generation
    provides: FR pages that the language switcher now links to
provides:
  - Language switcher integrated as first dropdown in main nav (not standalone component)
  - Mobile-first horizontal pill buttons for language switching
  - Liquid-based URL computation for language switching (no JavaScript)
  - Flag emojis on all language labels (IT/EN/FR only)
affects: [54-seo-phase, future-language-additions]

# Tech tracking
tech-stack:
  added: []
  patterns:
    - "nav-language CSS class for language-specific styling in nav"
    - "Liquid page.url manipulation for language URL computation"
    - "CSS order: -1 for mobile-first language switcher positioning"

key-files:
  created: []
  modified:
    - _includes/components/nav.liquid
    - _includes/components/header.liquid
    - src/styles/components.css
    - src/styles/mobile.css
    - src/scripts/app.js

key-decisions:
  - "Used Liquid template variables (not JS) for language URL computation — same approach as hreflang in base.liquid"
  - "Only IT/EN/FR shown — ES/ZH intentionally excluded (not implemented)"
  - "Mobile: horizontal pill buttons at top of hamburger menu, not dropdown"
  - "Kept language-switcher.liquid file on disk but removed all includes — can be deleted later"

patterns-established:
  - "Language dropdown: .nav-language as first .has-dropdown item in nav"
  - "Mobile language: horizontal pills with order: -1 and static positioning"

# Metrics
duration: 5min
completed: 2026-02-19
---

# Phase 53.1 Plan 03: Language Switcher in Nav Summary

**Language switcher moved from standalone dropdown into main navigation bar as first dropdown item with mobile-first horizontal pill layout**

## Performance

- **Duration:** 5 min (executor) + orchestrator corrections
- **Started:** 2026-02-19
- **Completed:** 2026-02-19
- **Tasks:** 2 auto + 1 checkpoint (human-verified)
- **Files modified:** 5

## Accomplishments
- Integrated language switcher as first dropdown item in nav.liquid using Liquid URL computation
- Added flag emojis to all language labels (trigger button + dropdown items)
- Removed standalone language-switcher include from header.liquid
- Removed old language switcher JavaScript handlers from app.js
- Added .nav-language desktop styles (components.css) and mobile horizontal pill layout (mobile.css)
- Removed old .language-switcher, .language-button, .language-dropdown CSS rules

## Orchestrator Corrections
After checkpoint review, the orchestrator fixed:
- Added flag emojis (was text-only initially)
- Fixed EN/FR homepage hero image paths (`../IMAGES/` for correct depth from `en/` and `fr/` subdirectories)
- Fixed pages.11tydata.js permalink check (plan 04's `.html` check broke static pages; corrected to `.xml`-only check)

## Task Commits

1. **Task 1: Integrate language switcher into nav** - `d1e7636` (feat)
2. **Task 2: CSS for language switcher** - `985fe0f` (feat)
3. **Orchestrator corrections** - `9a0cb17` (fix)

## Files Modified
- `_includes/components/nav.liquid` - Language switcher as first dropdown with Liquid URL logic + flag emojis
- `_includes/components/header.liquid` - Removed language-switcher.liquid include
- `src/styles/components.css` - Added .nav-language styles, removed old .language-switcher CSS
- `src/styles/mobile.css` - Added mobile horizontal pill layout with order: -1
- `src/scripts/app.js` - Removed old language switcher event handlers

## Decisions Made
- Liquid-based URL computation preferred over JavaScript for static site reliability
- Mobile layout uses horizontal pills (not dropdown) for better UX on touch devices
- Flag emojis added per user request during checkpoint review

## Deviations from Plan
- Plan suggested flag emojis but executor didn't include them; added during orchestrator correction
- pages.11tydata.js fix was needed due to interaction with plan 04's sitemap changes

## Issues Encountered
- EN/FR homepage images broke because hero SVG path needed `../` prefix from subdirectory pages
- pages.11tydata.js plan 04 change (`!.endsWith('.html')`) broke static page output — fixed to `.endsWith('.xml')` only

## User Setup Required
None.

## Next Phase Readiness
- All 5 plans in phase 53.1 are now complete
- Ready for phase verification

---
*Phase: 53.1-tech-debt*
*Completed: 2026-02-19*
