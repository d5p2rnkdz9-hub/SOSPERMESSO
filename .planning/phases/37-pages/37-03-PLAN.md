---
phase: 37-pages
plan: 03
type: execute
wave: 2
depends_on: ["37-01"]
files_modified:
  - en/src/pages/*.html
autonomous: true

must_haves:
  truths:
    - "All 204 EN pages in en/src/pages converted to use shared layouts"
    - "EN pages render with shared header/footer"
    - "EN pages have English navigation and footer labels"
  artifacts:
    - path: "en/src/pages/permesso-studio.html"
      provides: "Sample migrated EN permit page"
      contains: "layout: layouts/base.liquid"
    - path: "en/src/pages/database.html"
      provides: "Sample migrated EN page with inline styles"
      contains: "layout: layouts/base.liquid"
  key_links:
    - from: "en/src/pages/*.html"
      to: "_includes/layouts/base.liquid"
      via: "front matter layout"
      pattern: "layout: layouts/base.liquid"
---

<objective>
Migrate all 204 English pages in en/src/pages/ to use the shared layout.

Purpose: Convert EN pages (PAGE-02) to eliminate duplicated header/footer HTML
Output: All EN pages in en/src/pages/ have front matter and use base.liquid layout with lang: en
</objective>

<execution_context>
@/Users/albertopasquero/.claude/get-shit-done/workflows/execute-plan.md
@/Users/albertopasquero/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/37-pages/37-RESEARCH.md
@.planning/phases/37-pages/37-01-SUMMARY.md
@scripts/migrate-pages.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate EN pages</name>
  <files>en/src/pages/*.html (204 files)</files>
  <action>
Run the migration script on all EN pages in en/src/pages/:

```bash
# Process all HTML files in en/src/pages/
node scripts/migrate-pages.js "en/src/pages/*.html"
```

The script will:
- Add front matter with layout, title, lang: en (detects from path starting with "en/")
- Extract content between header and footer
- Remove header, footer, head, standard scripts
- Preserve inline styles via extraStyles
- Preserve page-specific scripts

After migration, verify sample pages:
1. en/src/pages/permesso-studio.html - standard permit page
2. en/src/pages/database.html - page with inline styles
3. en/src/pages/chi-siamo.html - about page

Each should have `lang: en` in front matter.
  </action>
  <verify>
```bash
# Check sample pages have front matter with lang: en
head -10 en/src/pages/permesso-studio.html | grep -q "lang: en" && echo "permesso-studio EN OK"
head -10 en/src/pages/database.html | grep -q "lang: en" && echo "database EN OK"
head -10 en/src/pages/chi-siamo.html | grep -q "lang: en" && echo "chi-siamo EN OK"

# Verify count
grep -l "layout: layouts/base.liquid" en/src/pages/*.html | wc -l
# Should be 204

# Build
npm run build
```
  </verify>
  <done>All 204 EN pages have front matter with lang: en, build succeeds</done>
</task>

<task type="auto">
  <name>Task 2: Verify EN pages render correctly</name>
  <files>None (verification only)</files>
  <action>
Verify the migration by checking:

1. Build output count:
   - `find _site/en/src/pages -name "*.html" | wc -l` should be 204

2. No double headers/footers:
   ```bash
   grep -c "<header" _site/en/src/pages/permesso-studio.html  # Should be 1
   grep -c "<footer" _site/en/src/pages/permesso-studio.html  # Should be 1
   ```

3. Lang attribute correct:
   ```bash
   grep -o '<html lang="[^"]*"' _site/en/src/pages/permesso-studio.html
   # Should show lang="en"
   ```

4. English labels in navigation:
   ```bash
   grep -q "Database" _site/en/src/pages/permesso-studio.html && echo "EN nav OK"
   grep -q "The Project" _site/en/src/pages/permesso-studio.html && echo "EN footer OK"
   ```

5. Content preserved (spot check breadcrumb):
   ```bash
   grep -q "breadcrumb" _site/en/src/pages/permesso-studio.html && echo "Breadcrumb OK"
   ```

If any verification fails, identify the issue and fix.
  </action>
  <verify>
```bash
echo "EN output count:" && find _site/en/src/pages -name "*.html" | wc -l
echo "Header count (should be 1):" && grep -c "<header" _site/en/src/pages/permesso-studio.html
echo "Footer count (should be 1):" && grep -c "<footer" _site/en/src/pages/permesso-studio.html
echo "Lang attribute:" && grep -o '<html lang="[^"]*"' _site/en/src/pages/permesso-studio.html
```
  </verify>
  <done>204 EN pages output correctly with single header/footer, correct lang="en", English labels in nav/footer</done>
</task>

</tasks>

<verification>
- All 204 EN pages in en/src/pages/ have front matter
- `npm run build` succeeds
- Output count matches input count (204)
- Sample pages have exactly one header and one footer
- HTML lang attribute is "en" for all EN pages
- Navigation shows English labels (Database, Guide, etc.)
- Footer shows English labels (The Project, About Us, etc.)
</verification>

<success_criteria>
1. All 204 files in en/src/pages/ have `layout: layouts/base.liquid` in front matter
2. All 204 files have `lang: en` in front matter
3. Build produces 204 HTML files in _site/en/src/pages/
4. No page has duplicate header or footer
5. Components render with English labels based on lang: en
</success_criteria>

<output>
After completion, create `.planning/phases/37-pages/37-03-SUMMARY.md`
</output>
