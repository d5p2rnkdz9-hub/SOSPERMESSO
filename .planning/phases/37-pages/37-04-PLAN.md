---
phase: 37-pages
plan: 04
type: execute
wave: 3
depends_on: ["37-02", "37-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All ~410 pages render correctly with shared layouts"
    - "IT pages have Italian header/footer labels"
    - "EN pages have English header/footer labels"
    - "URL structure unchanged from before migration"
    - "No visual regression from original site"
  artifacts: []
  key_links: []
---

<objective>
Final verification of the complete page migration.

Purpose: Ensure all requirements (PAGE-01 through PAGE-04, I18N-01 through I18N-03) are met
Output: Visual verification + automated checks confirming complete migration success
</objective>

<execution_context>
@/Users/albertopasquero/.claude/get-shit-done/workflows/execute-plan.md
@/Users/albertopasquero/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/37-pages/37-RESEARCH.md
@.planning/phases/37-pages/37-02-SUMMARY.md
@.planning/phases/37-pages/37-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run comprehensive verification checks</name>
  <files>None (verification only)</files>
  <action>
Run a comprehensive verification of all migrated pages:

1. **Total page count:**
   ```bash
   echo "Source IT pages:" && find src/pages -name "*.html" | wc -l
   echo "Source EN pages:" && find en/src/pages -name "*.html" | wc -l
   echo "Root IT files:" && ls -1 *.html 2>/dev/null | grep -v google | wc -l
   echo "Root EN files:" && ls -1 en/*.html 2>/dev/null | wc -l
   echo "---"
   echo "Output IT pages:" && find _site/src/pages -name "*.html" | wc -l
   echo "Output EN pages:" && find _site/en/src/pages -name "*.html" | wc -l
   echo "Output root IT:" && ls -1 _site/*.html 2>/dev/null | grep -v google | wc -l
   echo "Output root EN:" && ls -1 _site/en/*.html 2>/dev/null | wc -l
   ```

2. **Front matter presence (all pages should have layout):**
   ```bash
   echo "IT pages with layout:" && grep -l "layout: layouts/base.liquid" src/pages/*.html | wc -l
   echo "EN pages with layout:" && grep -l "layout: layouts/base.liquid" en/src/pages/*.html | wc -l
   ```

3. **Lang attribute verification:**
   ```bash
   # IT pages should have lang="it"
   echo "IT pages with wrong lang:" && grep -L 'lang: it' src/pages/*.html | wc -l
   # EN pages should have lang="en"
   echo "EN pages with wrong lang:" && grep -L 'lang: en' en/src/pages/*.html | wc -l
   ```

4. **No duplicate headers/footers (sample check):**
   ```bash
   for f in permesso-studio database chi-siamo; do
     echo "IT $f header count:" $(grep -c "<header" _site/src/pages/$f.html)
     echo "EN $f header count:" $(grep -c "<header" _site/en/src/pages/$f.html)
   done
   ```

5. **URL preservation:**
   ```bash
   # Check that URLs match expected patterns
   ls _site/src/pages/permesso-studio.html && echo "IT permit URL OK"
   ls _site/en/src/pages/permesso-studio.html && echo "EN permit URL OK"
   ls _site/src/pages/documenti-questura.html && echo "IT docs URL OK"
   ```

Report any discrepancies found.
  </action>
  <verify>
```bash
npm run build && echo "Build successful"
# Source and output counts should match
test $(find src/pages -name "*.html" | wc -l) -eq $(find _site/src/pages -name "*.html" | wc -l) && echo "IT counts match"
test $(find en/src/pages -name "*.html" | wc -l) -eq $(find _site/en/src/pages -name "*.html" | wc -l) && echo "EN counts match"
```
  </verify>
  <done>All automated verification checks pass, counts match, no duplicate components detected</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete migration of all ~410 pages to use shared 11ty layouts</what-built>
  <how-to-verify>
**Visual spot-check (5 minutes):**

1. **IT Homepage** - `_site/index.html`
   - Header with logo, navigation dropdowns, language switcher
   - Lighthouse hero section with animations
   - Footer with Italian labels (Il Progetto, Chi Siamo, Contatti)
   - No duplicate header/footer

2. **EN Homepage** - `_site/en/index.html`
   - Header with English labels (Database, Guide, Test, Collaborate)
   - Footer with English labels (The Project, About Us, Contact)
   - No duplicate header/footer

3. **IT Permit Page** - `_site/src/pages/permesso-studio.html`
   - Breadcrumb navigation visible
   - Page content (Q&A sections, requirements, etc.)
   - Header and footer present (single instance each)
   - Italian navigation labels

4. **EN Permit Page** - `_site/en/src/pages/permesso-studio.html`
   - Same structure as IT but English header/footer
   - Content matches (same visual layout)

5. **IT Database Page** - `_site/src/pages/database.html`
   - Category cards with colored backgrounds (inline styles working)
   - Permit listings visible
   - Header/footer present

6. **Navigation Test:**
   - Click a dropdown in IT page - links should work
   - Click a dropdown in EN page - links should work
   - Language switcher visible and shows correct current language

**Requirements checklist:**
- [ ] PAGE-01: IT pages use shared layouts (header/footer from includes)
- [ ] PAGE-02: EN pages use shared layouts (header/footer from includes)
- [ ] PAGE-03: Front matter visible (view source shows ---layout: layouts/base.liquid---)
- [ ] PAGE-04: Content unchanged (same Q&A sections, breadcrumbs, etc.)
- [ ] I18N-01: IT pages at root URLs (/src/pages/permesso-studio.html)
- [ ] I18N-02: EN pages at /en/ URLs (/en/src/pages/permesso-studio.html)
- [ ] I18N-03: HTML lang attribute correct (view source: `<html lang="it">` or `<html lang="en">`)
  </how-to-verify>
  <resume-signal>Type "approved" if all requirements verified, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
- Build succeeds
- Source page count matches output page count
- All IT pages have lang: it
- All EN pages have lang: en
- No duplicate headers or footers
- Visual verification confirms correct rendering
- All 7 requirements (PAGE-01 to PAGE-04, I18N-01 to I18N-03) met
</verification>

<success_criteria>
1. Total page count matches before/after migration
2. All automated verification checks pass
3. Visual spot-check confirms:
   - Shared header/footer rendering correctly
   - Language-specific labels (IT vs EN)
   - Inline styles preserved (database.html, index.html)
   - Content unchanged
4. User confirms "approved" for all 7 requirements
</success_criteria>

<output>
After completion, create `.planning/phases/37-pages/37-04-SUMMARY.md`
</output>
