---
phase: 43-populate-blank-permits
plan: 04
type: execute
wave: 4
depends_on: ["43-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All blank cure mediche permits have Q&A content in Notion"
    - "All blank motivi familiari permits have Q&A content in Notion"
    - "All blank 'altro' category permits have Q&A content in Notion"
    - "Zero placeholder permit pages remain after build"
    - "CONTENT-01 requirement satisfied: all placeholder permits populated"
    - "CONTENT-02 requirement satisfied: generated pages render correctly"
  artifacts:
    - path: ".planning/phases/43-populate-blank-permits/43-04-SUMMARY.md"
      provides: "List of remaining permits populated, final build verification, phase completion status"
  key_links:
    - from: "Notion page blocks (all permits)"
      to: "_data/permits.js"
      via: "Notion API fetch during build"
      pattern: "isPlaceholder === false for all permits"
---

<objective>
Populate all remaining blank permits (cure mediche, motivi familiari, altro) with Q&A content in Notion. Complete Phase 43.

Purpose: After protezione (Plan 02) and lavoro (Plan 03), this plan handles the remaining categories to achieve zero placeholder permit pages site-wide.

Output: All permit pages have Q&A content. No placeholder pages remain. CONTENT-01 and CONTENT-02 requirements satisfied.
</objective>

<execution_context>
@/Users/albertopasquero/.claude/get-shit-done/workflows/execute-plan.md
@/Users/albertopasquero/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/43-populate-blank-permits/43-CONTEXT.md
@.planning/phases/43-populate-blank-permits/43-RESEARCH.md
@.planning/phases/43-populate-blank-permits/43-01-SUMMARY.md
@.planning/phases/43-populate-blank-permits/43-02-SUMMARY.md
@.planning/phases/43-populate-blank-permits/43-03-SUMMARY.md
@_data/permits.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write Q&A content for cure mediche, motivi familiari, and altro permits</name>
  <files>None (Notion writes only)</files>
  <action>
Using the categorized list from Plan 01 SUMMARY, process ALL remaining permits that need content across these categories:

**Cure mediche** (likely needing content):
- Cure mediche (art.36 d. lgs 286/1998) — ID: `1b27355e-7f7f-8076-9826-ddcacea91bf7`

**Motivi familiari** (verify against 01 SUMMARY — may be empty if all familiari permits already have content)

**Altro** (likely needing content):
- Residenza elettiva — the surviving page after duplicate merge in Plan 01
- Motivi religiosi — the surviving page after duplicate merge in Plan 01
- Acquisto cittadinanza o stato di apolide — ID: `1ad7355e-7f7f-809b-b8fb-e9c19fb89c4d`

**For each blank permit, follow the same process as Plans 02 and 03:**

1. Read existing data from Notion database columns using `notion-fetch`
2. Check for backfill content in `src/pages/permesso-*.html`
3. Transform column data + NOTES into Q&A narrative:

   For **cure mediche** permits:
   - Emphasize medical condition requirements and documentation
   - Explain relationship between medical permit and healthcare access
   - Note any temporary/emergency nature of the permit

   For **altro** permits:
   - Residenza elettiva: explain this is for financially independent residents (no work needed)
   - Motivi religiosi: explain this covers religious workers/leaders
   - Acquisto cittadinanza: explain this is a transitional permit while citizenship/statelessness is processed

   Standard sections:
   ```
   **Che cos'e questo permesso?**
   **Chi puo chiederlo?**
   **Come/dove si chiede?**
   **Che diritti mi da? A cosa ho accesso?**
   **Quanto dura questo permesso?**
   **Quando scade posso rinnovarlo?**
   **Posso convertirlo in un altro permesso?**
   ```

4. Write content to Notion using `notion-update-page` MCP tool
5. Verify each write by re-fetching the page

**Tone reminders:**
- Same conversational "tu" tone as all previous batches
- For medical permits: be especially sensitive and clear — users may be in vulnerable situations
- For residenza elettiva: explain the financial independence requirement simply
  </action>
  <verify>
- Each remaining category permit has Q&A blocks in Notion
- At least 5 Q&A sections per permit
- Medical permits use sensitive, clear language
  </verify>
  <done>All remaining category permits have Q&A content in Notion.</done>
</task>

<task type="auto">
  <name>Task 2: Final build and comprehensive verification</name>
  <files>None (build output in _site/)</files>
  <action>
1. Run the build: `npm run build` from project root.

2. **Comprehensive check — verify ALL permits, not just this batch:**
   - Scan build log for any permits still showing `isPlaceholder: true`
   - Count total permits rendered vs total permits in database
   - Verify zero "Contenuto in arrivo" placeholder text in any `_site/permesso-*.html` file

3. Run a quick grep across all built permit pages:
   ```bash
   grep -l "Contenuto in arrivo" _site/permesso-*.html
   ```
   This should return zero results. If any are found, those permits still need content.

4. Verify the build output count matches expectations:
   - Build log should show "[permits.js] Returning N total permit objects"
   - All N should have content (sections > 0)
   - The 2 "Unknown" entries should still be skipped (no tipo defined)

5. Document final state:
   - Total permits with content
   - Total permits still placeholder (should be 0)
   - Any issues or edge cases discovered
  </action>
  <verify>
- `npm run build` completes without errors
- `grep "Contenuto in arrivo" _site/permesso-*.html` returns zero results
- Build log shows all permits have sections
  </verify>
  <done>Build produces zero placeholder pages. CONTENT-01 and CONTENT-02 requirements satisfied.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Q&A content for all remaining permit categories (cure mediche, motivi familiari, altro). This completes Phase 43 — all permit pages now have content. Zero placeholder pages remain.</what-built>
  <how-to-verify>
1. Open the built site locally or check `_site/` directory
2. Review the remaining category pages:
   - Cure mediche pages: accurate medical information, sensitive tone
   - Residenza elettiva: financial independence explained clearly
   - Motivi religiosi: religious worker context explained
   - Acquisto cittadinanza: transitional nature explained
3. **Spot-check a few permits from ALL categories** (not just this batch):
   - Pick 2-3 protezione permits (from Plan 02)
   - Pick 2-3 lavoro permits (from Plan 03)
   - Pick 2-3 from this batch
   Ensure all render properly and content quality is consistent
4. Run `grep -l "Contenuto in arrivo" _site/permesso-*.html` — should return nothing
5. Browse database.html and click through to several permit pages to test navigation
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 43, or describe issues to fix.</resume-signal>
</task>

</tasks>

<verification>
1. All remaining category permits populated in Notion
2. Zero placeholder permit pages after build (grep confirmation)
3. User has spot-checked remaining categories AND cross-checked earlier batches
4. CONTENT-01 satisfied: all 17 (or adjusted count) placeholder permits populated
5. CONTENT-02 satisfied: all generated pages render correctly with Q&A content
</verification>

<success_criteria>
- Zero permits with "Contenuto in arrivo" placeholder across entire site
- User-approved content quality for all categories
- Build completes without errors
- Phase 43 requirements (CONTENT-01, CONTENT-02) fully met
</success_criteria>

<output>
After completion, create `.planning/phases/43-populate-blank-permits/43-04-SUMMARY.md` with:
- List of remaining permits populated (name, ID, section count)
- Final permit count: total with content vs total placeholder
- CONTENT-01 and CONTENT-02 requirement status
- User feedback from final checkpoint
- Phase 43 completion declaration
</output>
