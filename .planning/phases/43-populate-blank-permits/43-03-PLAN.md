---
phase: 43-populate-blank-permits
plan: 03
type: execute
wave: 3
depends_on: ["43-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All blank lavoro permits have Q&A content in Notion page blocks"
    - "Content matches reference model tone (conversational, tu address, accessible language)"
    - "Standard 7 Q&A sections present where data supports them"
    - "Build produces permit pages with rendered Q&A sections (no placeholder text)"
  artifacts:
    - path: ".planning/phases/43-populate-blank-permits/43-03-SUMMARY.md"
      provides: "List of lavoro permits populated, content written, build verification"
  key_links:
    - from: "Notion page blocks"
      to: "_data/permits.js"
      via: "Notion API fetch during build"
      pattern: "fetchPageBlocks -> parseQASections"
---

<objective>
Populate all blank lavoro (work) category permits with Q&A content in Notion.

Purpose: Lavoro permits are the largest category and most commonly sought by economic migrants. This batch covers employment, self-employment, sports, artistic work, research, internships, and regularization permits.

Output: All lavoro permits have Q&A page blocks in Notion. Built pages render with full content.
</objective>

<execution_context>
@/Users/albertopasquero/.claude/get-shit-done/workflows/execute-plan.md
@/Users/albertopasquero/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/43-populate-blank-permits/43-CONTEXT.md
@.planning/phases/43-populate-blank-permits/43-RESEARCH.md
@.planning/phases/43-populate-blank-permits/43-01-SUMMARY.md
@.planning/phases/43-populate-blank-permits/43-02-SUMMARY.md
@_data/permits.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write Q&A content for lavoro permits</name>
  <files>None (Notion writes only)</files>
  <action>
Using the categorized list from Plan 01 SUMMARY, process all **lavoro** category permits that need content.

**Known lavoro permits likely needing content** (verify against 01 SUMMARY):
- Lavoro subordinato a seguito di ingresso per flussi — ID: `1ad7355e-7f7f-807a-8378-d6163eb5742e`
- Lavoro autonomo — ID: `1ad7355e-7f7f-80d0-8eb7-eaf89571f818`
- Attivita sportiva (art.27) — ID: `2dc7355e-7f7f-80d8-b0a5-c82c9b24043c`
- Attivita sportiva — ID: `1ad7355e-7f7f-80c4-847b-f94b215df3e6`
- Ricerca scientifica (art.27ter) — ID: `1ad7355e-7f7f-8067-ad48-ef7ac7a43a83`
- Lavoro artistico — ID: `1ad7355e-7f7f-805b-ba6b-dbff5529fc7f`
- Lavoro subordinato a seguito di sanatoria — ID: `1ad7355e-7f7f-8054-a4a1-e9f4a31686d4`
- Tirocinio — ID: `1ad7355e-7f7f-80b1-bf0e-ced1be3cd742`

**IMPORTANT: Attivita sportiva appears twice.** Check if these are duplicates (same name, different IDs) or if one is a variant (e.g., one is "art.27" specific). If duplicate, merge per Plan 01 approach. If distinct, populate both.

**For each blank permit, follow the same process as Plan 02:**

1. Read existing data from Notion database columns using `notion-fetch`
2. Check for backfill content in `src/pages/permesso-*.html`
3. Transform column data + NOTES into Q&A narrative following the reference model:

   ```
   **Che cos'e questo permesso?**
   [Narrative. For work permits, explain the specific employment context.]

   **Chi puo chiederlo?**
   [Who qualifies. For flussi: who entered through decreto flussi. For sanatoria: who regularized.]

   **Come/dove si chiede?**
   [From Mod primo rilascio column.]

   **Che diritti mi da? A cosa ho accesso?**
   [From Posso lavorare? column. Work permits typically allow employment + SSN + residenza.]

   **Quanto dura questo permesso?**
   [From Quanto dura? column.]

   **Quando scade posso rinnovarlo?**
   [From NOTES or general renewal info.]

   **Posso convertirlo in un altro permesso?**
   [From posso convertire? column. Only if value exists.]
   ```

4. Write content to Notion using `notion-update-page` MCP tool
5. Verify each write by re-fetching the page

**Special handling for variant permits** (a seguito di...):
- Lavoro subordinato a seguito di ingresso per flussi — this is a variant child. Content should focus on what's SPECIFIC to the flussi pathway (how entry happened, specific documents), not general lavoro subordinato info.
- Lavoro subordinato a seguito di sanatoria — variant child. Focus on sanatoria-specific pathway.
- If these have parent pages already with content, write only variant-specific info.

**Tone reminders:**
- "tu" address, short sentences, simple words
- For work permits: explain what TYPE of work is allowed (subordinato = employed by someone, autonomo = self-employed, etc.)
- Document lists as bullet points
- If NOTES mention discrepancies between sources, add a callout block: "Attenzione: su questo punto ci sono informazioni contrastanti..."
  </action>
  <verify>
- Each lavoro permit page has Q&A blocks when fetched from Notion (run notion-fetch for each page ID, confirm block count > 0 with heading + paragraph block types)
- At least 5 Q&A sections per permit
- Variant permits have variant-specific content (not generic)
- Attivita sportiva duplicate situation resolved
  </verify>
  <done>All lavoro permits have Q&A content in Notion matching reference model tone and structure.</done>
</task>

<task type="auto">
  <name>Task 2: Build and verify lavoro pages</name>
  <files>None (build output in _site/)</files>
  <action>
1. Run the build: `npm run build` from project root.

2. Check build output for each lavoro permit:
   - Verify built HTML files exist in `_site/permesso-*.html`
   - Verify they contain Q&A section cards
   - Verify no placeholder "Contenuto in arrivo" text
   - Verify variant child pages link correctly to parent pages

3. Specifically check variant pages:
   - `_site/permesso-lavoro-subordinato-a-seguito-di-ingresso-per-flussi.html` should have variant-specific content
   - `_site/permesso-lavoro-subordinato-a-seguito-di-sanatoria.html` should have sanatoria-specific content
   - Both should show "Torna alle informazioni generali" link to parent

4. Count Q&A sections and note any rendering issues.
  </action>
  <verify>
- `npm run build` completes without errors
- Each lavoro permit page in `_site/` contains Q&A cards (not placeholder)
- Variant pages render with parent link and variant-specific content
  </verify>
  <done>Build produces rendered Q&A pages for all lavoro permits.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Q&A content for all lavoro category permits (employment, self-employment, sports, artistic, research, internship, regularization). Content written to Notion and rendered via 11ty build.</what-built>
  <how-to-verify>
1. Open the built site locally or check `_site/` directory
2. Review each lavoro permit page:
   - Tone matches reference (conversational, simple)
   - Content accuracy (does the work type description match?)
   - Variant pages have variant-specific info (not just copying parent)
   - Document checklists render as lists
3. Key pages to check:
   - `_site/permesso-lavoro-autonomo.html` or its variant equivalent
   - `_site/permesso-ricerca-scientifica-art-27ter.html`
   - `_site/permesso-tirocinio.html`
   - Any variant child pages
  </how-to-verify>
  <resume-signal>Type "approved" to proceed to remaining categories, or describe issues to fix.</resume-signal>
</task>

</tasks>

<verification>
1. All lavoro permits populated in Notion (no blank page blocks)
2. Build produces Q&A pages (not placeholder pages) for all lavoro permits
3. Variant pages render correctly with parent links
4. User has spot-checked and approved the content quality
</verification>

<success_criteria>
- Zero lavoro permits showing "Contenuto in arrivo" placeholder
- User-approved content tone and accuracy for lavoro batch
- Variant pages properly differentiated from parent pages
- Build completes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/43-populate-blank-permits/43-03-SUMMARY.md` with:
- List of lavoro permits populated (name, ID, section count)
- Duplicate resolution for Attivita sportiva (if applicable)
- Variant page handling notes
- User feedback from checkpoint
</output>
