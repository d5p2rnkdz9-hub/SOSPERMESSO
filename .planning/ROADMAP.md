# Roadmap: SOS Permesso

## Milestones

- âœ… **v1.1 Documenti Questura** - Phases 1-3 (shipped 2026-01-25)
- âœ… **v1.2 Visual Refresh** - Phases 4-9 (shipped 2026-01-26)
- âœ… **v1.4 Error Reporting + Dropdown Nav** - Phases 10-11 (shipped 2026-01-27)
- âœ… **v1.5 Footer + Collabora Nav** - Phases 12-14 (shipped 2026-01-28)
- âœ… **v1.6 Document Deduplication** - Phase 15 (shipped 2026-01-28)
- âœ… **v1.7 Database Content Reviewed** - Phases 16-17 (shipped 2026-01-30)
- âœ… **v1.9 SEO Foundations** - Phase 18 (shipped 2026-01-31)
- âœ… **v2.0 Multilingual Foundation** - Phase 20 (shipped 2026-02-02)
- âœ… **v2.2 Language Infrastructure** - Phases 32-34.1 (shipped 2026-02-04)
- âœ… **v3.0 11ty Migration** - Phases 35-38 (shipped 2026-02-05)
- âœ… **v3.1 Prassi Locali + Notion-11ty Completion** - Phases 39-46 (shipped 2026-02-17)
- ðŸš§ **v3.2 EN Translation Pipeline** - Phases 47-50 (in progress)

---

<details>
<summary>âœ… v3.1 Prassi Locali + Notion-11ty Completion (Phases 39-46) - SHIPPED 2026-02-17</summary>

### Phase 39: Document Pages
**Goal:** Document pages generated via 11ty data + templates.
**Status:** Complete (2026-02-07)
**Plans:** 2 plans â€” [x] 39-01, [x] 39-02

### Phase 40: Permit Pages
**Goal:** Permit pages generated via 11ty data + templates.
**Status:** Complete (2026-02-09)
**Plans:** 2 plans â€” [x] 40-01, [x] 40-02

### Phase 41: Prassi Locali MVP
**Goal:** Crowdsourced local questura practices on document pages.
**Status:** Complete (2026-02-10)
**Plans:** 4 plans â€” [x] 41-01, [x] 41-02, [x] 41-03, [x] 41-04

### Phase 42: Build Pipeline
**Goal:** Unified build command, old script cleanup.
**Status:** Complete (2026-02-14)
**Plans:** 3 plans â€” [x] 42-01, [x] 42-02, [x] 42-03

### Phase 42.1: Fix Prassi Integration (INSERTED)
**Goal:** Fix prassi section not rendering in built document pages.
**Status:** Complete (2026-02-14)
**Plans:** 1 plan â€” [x] 42.1-01

### Phase 42.2: Requirements & Docs Cleanup (INSERTED)
**Goal:** Bring requirements tracking up to date.
**Status:** Complete (2026-02-14)
**Plans:** 1 plan â€” [x] 42.2-01

### Phase 43: Populate Blank Permits
**Goal:** Add Notion content for all placeholder permit pages.
**Status:** Complete (2026-02-16)
**Plans:** 4 plans â€” [x] 43-01, [x] 43-02, [x] 43-03, [x] 43-04

### Phase 44: Costi Section
**Goal:** Itemized cost breakdown on document pages from Notion data.
**Status:** Complete (2026-02-16)
**Plans:** 1 plan â€” [x] 44-01

### Phase 44.1: URL Coverage & Content Preservation (INSERTED)
**Goal:** Ensure every Notion DB permit has a working HTML page with correct redirects.
**Status:** Complete (2026-02-17)
**Plans:** 3 plans â€” [x] 44.1-01, [x] 44.1-02, [x] 44.1-03

### Phase 45: Content Validation
**Status:** Deferred to future milestone.

### Phase 46: Dizionario Link Revision
**Status:** Deferred to future milestone.

</details>

---

## ðŸš§ v3.2 EN Translation Pipeline (In Progress)

**Milestone Goal:** Connect English pages to the same 11ty/Notion pipeline as Italian, replacing 136 frozen static EN files with dynamically generated pages. Add Notion response caching for incremental builds.

**Phases:** 47-50
**Created:** 2026-02-18

| Phase | Goal | Requirements |
|-------|------|--------------|
| 47 - Notion Cache | Build only re-fetches pages that changed | CACHE-01, CACHE-02, CACHE-03 |
| 48 - Translation Script | IT content translated to EN, written back to Notion | TRANS-01..05 |
| 49 - EN Page Generation | EN pages generated by 11ty from Notion EN data | ENGEN-01..04 |
| 50 - Static Pages + Cleanup | Changed static pages re-translated, old EN files removed | STATIC-01, CLEAN-01 |

---

### Phase 47: Notion Cache

**Goal:** Build only re-fetches Notion pages that changed since the last build.
**Status:** Complete (2026-02-18)
**Plans:** 2 plans â€” [x] 47-01, [x] 47-02

---

### Phase 48: Translation Script

**Goal:** IT permit and document content is translated to EN via Claude API and written back to Notion as EN properties, with section-level change detection preventing re-translation of unchanged content.

**Depends on:** Phase 47 (cache makes translate step faster; both read same cached Notion responses)

**Requirements:** TRANS-01, TRANS-02, TRANS-03, TRANS-04, TRANS-05

**Success Criteria** (what must be TRUE):
1. Running `npm run translate` produces EN translations of all permit Q&A sections in Notion
2. Running `npm run translate` again with no IT source changes skips all sections (section hashes match)
3. Editing one Q&A section in Notion and re-running translate updates only that section in Notion EN columns
4. Translated text uses the 35+ term glossary consistently (e.g., "permesso di soggiorno" â†’ "residence permit")
5. Document content (names, notes, application methods) is translated and written to Notion EN columns

**Status:** Complete (2026-02-18, commit d1f36d5)
**Plans:** 1 plan (implemented outside GSD) â€” [x] 48-01

---

### Phase 49: EN Page Generation

**Goal:** EN permit pages and document pages (primo + rinnovo) are generated by 11ty from Notion EN data, output at `/en/` prefix with correct asset paths, and language switcher links correctly between IT and EN.

**Depends on:** Phase 48 (translated EN content must exist in Notion before 11ty can read it)

**Requirements:** ENGEN-01, ENGEN-02, ENGEN-03, ENGEN-04

**Success Criteria** (what must be TRUE):
1. Build produces `/en/permesso-*.html` files for all 43 permits
2. Build produces `/en/documenti-*-primo.html` and `/en/documenti-*-rinnovo.html` for all document types
3. EN pages reference asset paths with `/` prefix (not broken relative paths)
4. Clicking the language switcher on any IT permit page navigates to the correct EN page and vice versa

**Status:** Complete (2026-02-18)
**Plans:** 3 plans â€” [x] 49-01, [x] 49-02, [x] 49-03

Plans:
- [x] 49-01: EN data files (permitsEn.js, documentsEn.js) reading Notion EN database
- [x] 49-02: EN Liquid templates + static file cleanup
- [x] 49-03: Build verification + language switcher spot-check

---

### Phase 50: Static Pages + Cleanup

**Goal:** Static pages that changed since v2.0 are re-translated to EN, and old frozen static EN files are removed after generated replacements are verified.

**Depends on:** Phase 49 (generated EN pages must be verified working before old files are deleted)

**Requirements:** STATIC-01, CLEAN-01

**Success Criteria** (what must be TRUE):
1. Static EN pages that diverged from their IT counterparts since v2.0 reflect current IT content
2. Running `npm run build` produces all expected EN pages with no missing pages
3. Old 136 static EN files no longer exist in the repo
4. Navigating to any `/en/` URL on the live site returns a working page (no 404s)

**Plans:** TBD

Plans:
- [ ] 50-01: Audit static EN pages against current IT source, re-translate changed pages
- [ ] 50-02: Delete old static EN files, rebuild, verify zero 404s

---

## Progress

| Phase | Milestone | Plans Complete | Status | Completed |
|-------|-----------|----------------|--------|-----------|
| 47. Notion Cache | v3.2 | 2/2 | âœ“ Complete | 2026-02-18 |
| 48. Translation Script | v3.2 | 1/1 | âœ“ Complete | 2026-02-18 |
| 49. EN Page Generation | v3.2 | 3/3 | âœ“ Complete | 2026-02-18 |
| 50. Static Pages + Cleanup | v3.2 | 0/2 | Not started | - |

---

*Roadmap created: 2026-02-18 â€” v3.2 EN Translation Pipeline*
*Previous milestone: v3.1 (Phases 39-46) shipped 2026-02-17*
