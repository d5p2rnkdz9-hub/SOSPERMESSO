# Roadmap: SOS Permesso

## Milestones

- âœ… **v1.1 Documenti Questura** - Phases 1-3 (shipped 2026-01-25)
- âœ… **v1.2 Visual Refresh** - Phases 4-9 (shipped 2026-01-26)
- âœ… **v1.4 Error Reporting + Dropdown Nav** - Phases 10-11 (shipped 2026-01-27)
- âœ… **v1.5 Footer + Collabora Nav** - Phases 12-14 (shipped 2026-01-28)
- âœ… **v1.6 Document Deduplication** - Phase 15 (shipped 2026-01-28)
- âœ… **v1.7 Database Content Reviewed** - Phases 16-17 (shipped 2026-01-30)
- âœ… **v1.9 SEO Foundations** - Phase 18 (shipped 2026-01-31)
- âœ… **v2.0 Multilingual Foundation** - Phase 20 (shipped 2026-02-02)
- âœ… **v2.2 Language Infrastructure** - Phases 32-34.1 (shipped 2026-02-04)
- âœ… **v3.0 11ty Migration** - Phases 35-38 (shipped 2026-02-05)
- âœ… **v3.1 Prassi Locali + Notion-11ty Completion** - Phases 39-46 (shipped 2026-02-17)
- âœ… **v3.2 EN Translation Pipeline** - Phases 47-50 (shipped 2026-02-18)
- ðŸš§ **v4.0 FR Translation** - Phases 51-54 (in progress)

---

<details>
<summary>âœ… v3.1 Prassi Locali + Notion-11ty Completion (Phases 39-46) - SHIPPED 2026-02-17</summary>

### Phase 39: Document Pages
**Goal:** Document pages generated via 11ty data + templates.
**Status:** Complete (2026-02-07)
**Plans:** 2 plans â€” [x] 39-01, [x] 39-02

### Phase 40: Permit Pages
**Goal:** Permit pages generated via 11ty data + templates.
**Status:** Complete (2026-02-09)
**Plans:** 2 plans â€” [x] 40-01, [x] 40-02

### Phase 41: Prassi Locali MVP
**Goal:** Crowdsourced local questura practices on document pages.
**Status:** Complete (2026-02-10)
**Plans:** 4 plans â€” [x] 41-01, [x] 41-02, [x] 41-03, [x] 41-04

### Phase 42: Build Pipeline
**Goal:** Unified build command, old script cleanup.
**Status:** Complete (2026-02-14)
**Plans:** 3 plans â€” [x] 42-01, [x] 42-02, [x] 42-03

### Phase 42.1: Fix Prassi Integration (INSERTED)
**Goal:** Fix prassi section not rendering in built document pages.
**Status:** Complete (2026-02-14)
**Plans:** 1 plan â€” [x] 42.1-01

### Phase 42.2: Requirements & Docs Cleanup (INSERTED)
**Goal:** Bring requirements tracking up to date.
**Status:** Complete (2026-02-14)
**Plans:** 1 plan â€” [x] 42.2-01

### Phase 43: Populate Blank Permits
**Goal:** Add Notion content for all placeholder permit pages.
**Status:** Complete (2026-02-16)
**Plans:** 4 plans â€” [x] 43-01, [x] 43-02, [x] 43-03, [x] 43-04

### Phase 44: Costi Section
**Goal:** Itemized cost breakdown on document pages from Notion data.
**Status:** Complete (2026-02-16)
**Plans:** 1 plan â€” [x] 44-01

### Phase 44.1: URL Coverage & Content Preservation (INSERTED)
**Goal:** Ensure every Notion DB permit has a working HTML page with correct redirects.
**Status:** Complete (2026-02-17)
**Plans:** 3 plans â€” [x] 44.1-01, [x] 44.1-02, [x] 44.1-03

### Phase 45: Content Validation
**Status:** Deferred to future milestone.

### Phase 46: Dizionario Link Revision
**Status:** Deferred to future milestone.

</details>

---

<details>
<summary>âœ… v3.2 EN Translation Pipeline (Phases 47-50) - SHIPPED 2026-02-18</summary>

**Milestone Goal:** Connect English pages to the same 11ty/Notion pipeline as Italian, replacing 136 frozen static EN files with dynamically generated pages. Add Notion response caching for incremental builds.

### Phase 47: Notion Cache
**Goal:** Build only re-fetches Notion pages that changed since the last build.
**Status:** Complete (2026-02-18)
**Plans:** 2 plans â€” [x] 47-01, [x] 47-02

### Phase 48: Translation Script
**Goal:** IT permit and document content is translated to EN via Claude API and written back to Notion as EN properties, with section-level change detection preventing re-translation of unchanged content.
**Status:** Complete (2026-02-18)
**Plans:** 1 plan â€” [x] 48-01

### Phase 49: EN Page Generation
**Goal:** EN permit pages and document pages (primo + rinnovo) are generated by 11ty from Notion EN data, output at `/en/` prefix with correct asset paths, and language switcher links correctly between IT and EN.
**Status:** Complete (2026-02-18)
**Plans:** 3 plans â€” [x] 49-01, [x] 49-02, [x] 49-03

### Phase 50: Static Pages + Cleanup
**Goal:** Static pages that changed since v2.0 are re-translated to EN, and old frozen static EN files are removed after generated replacements are verified.
**Status:** Complete (2026-02-18)
**Plans:** 2 plans â€” [x] 50-01, [x] 50-02

</details>

---

## ðŸš§ v4.0 FR Translation (In Progress)

**Milestone Goal:** Add French translation using the same Notion + 11ty pipeline as EN. Extend the translation script to support `--lang fr`, create a French Notion database, generate pages at `/fr/` prefix, and upgrade the language switcher and sitemaps to cover IT/EN/FR. ES translation follows in v4.1 if the FR pipeline works well.

**Phases:** 51-54
**Created:** 2026-02-18

| Phase | Goal | Requirements |
|-------|------|--------------|
| 51 - Translation Infrastructure | Script supports FR with dedicated glossary | TRANS-01, TRANS-03, TRANS-05 |
| 52 - Notion Database | FR Notion DB created with translated content | NOTION-01 |
| 53 - FR Page Generation | All FR pages generated by 11ty and deployed | FGEN-01, FGEN-02, FGEN-03 |
| 54 - SEO | Hreflang tags and sitemaps include FR | SEO-01, SEO-02 |

---

### Phase 51: Translation Infrastructure

**Goal:** The translation script can generate French translations of all IT permit and document content, applying a French-specific glossary and section-level hashing to skip unchanged content.

**Depends on:** Phase 47-48 (existing script and cache pattern is the starting point)

**Requirements:** TRANS-01, TRANS-03, TRANS-05

**Success Criteria** (what must be TRUE):
1. Running `npm run translate --lang fr` produces French translations of all permit Q&A sections in Notion
2. Re-running the command with no source changes skips all sections (hashes match, zero API calls)
3. French output consistently applies the FR glossary (e.g., "permesso di soggiorno" â†’ "titre de sÃ©jour")

**Status:** Not started
**Plans:** TBD

---

### Phase 52: Notion Database

**Goal:** A French Notion database exists and contains fully translated permit Q&A content and document data, ready for 11ty to read.

**Depends on:** Phase 51 (translation script must work before running it against Notion)

**Requirements:** NOTION-01

**Success Criteria** (what must be TRUE):
1. A French Notion database exists with translated entries for all 43 permits
2. The database contains translated document names, notes, and application method text
3. Running `npm run build` fetches content from the FR database without errors

**Status:** Not started
**Plans:** TBD

---

### Phase 53: FR Page Generation

**Goal:** French pages for all permit types, document types, and static sections are generated by 11ty and accessible at `/fr/` prefix, with the language switcher linking IT/EN/FR correctly.

**Depends on:** Phase 52 (FR Notion DB must exist before 11ty can read it)

**Requirements:** FGEN-01, FGEN-02, FGEN-03

**Success Criteria** (what must be TRUE):
1. Build produces `/fr/permesso-*.html` for all 43 permits
2. Build produces `/fr/documenti-*-primo.html` and `/fr/documenti-*-rinnovo.html` for all document types
3. FR static pages exist at `/fr/` (homepage, database listing, documenti-questura, chi-siamo)
4. Language switcher on any IT/EN page shows FR option and navigates to the correct translated page

**Status:** Not started
**Plans:** TBD

---

### Phase 54: SEO

**Goal:** Search engines can discover all FR pages with correct hreflang cross-references, and the sitemap index includes the FR sitemap.

**Depends on:** Phase 53 (pages must exist before they can be indexed)

**Requirements:** SEO-01, SEO-02

**Success Criteria** (what must be TRUE):
1. `sitemap-fr.xml` exists and lists all generated FR pages
2. `sitemap-index.xml` references all three language sitemaps (IT, EN, FR)
3. Hreflang tags on any page include a `fr` alternate link pointing to the correct translated page
4. No hreflang errors reported by Google Search Console tooling (self-referencing canonical + all language alternates present)

**Status:** Not started
**Plans:** TBD

---

## Progress

| Phase | Milestone | Plans Complete | Status | Completed |
|-------|-----------|----------------|--------|-----------|
| 47. Notion Cache | v3.2 | 2/2 | âœ“ Complete | 2026-02-18 |
| 48. Translation Script | v3.2 | 1/1 | âœ“ Complete | 2026-02-18 |
| 49. EN Page Generation | v3.2 | 3/3 | âœ“ Complete | 2026-02-18 |
| 50. Static Pages + Cleanup | v3.2 | 2/2 | âœ“ Complete | 2026-02-18 |
| 51. Translation Infrastructure | v4.0 | 0/? | Not started | - |
| 52. Notion Database | v4.0 | 0/? | Not started | - |
| 53. FR Page Generation | v4.0 | 0/? | Not started | - |
| 54. SEO | v4.0 | 0/? | Not started | - |

---

*Roadmap created: 2026-02-18 â€” v4.0 FR + ES Translation*
*Revised: 2026-02-18 â€” scoped to FR only; ES deferred to v4.1*
*Previous milestone: v3.2 (Phases 47-50) shipped 2026-02-18*
