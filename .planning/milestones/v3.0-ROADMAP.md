# Milestone v3.0: 11ty Migration

**Status:** SHIPPED 2026-02-05
**Phases:** 35-38
**Total Plans:** 8

## Overview

Migrate from pure HTML to 11ty SSG for maintainable architecture. Extract shared components, keep same content and URLs.

**Goal:** Eliminate duplicated headers/footers across 469 files by converting to 11ty with shared layouts.

**Target features:**
- 11ty v3.x with Liquid templates
- Passthrough copy for CSS/JS/images
- Base layout with header/footer/nav as includes
- Language switcher as include
- All 469 pages converted to use layouts
- URL preservation (no broken links)
- Netlify deployment configured

## Phases

### Phase 35: Setup

**Goal:** 11ty v3.x installed and configured with Liquid templates, all URLs preserved.
**Depends on:** Phase 34 (RTL Infrastructure)
**Plans:** 1 plan

Plans:
- [x] 35-01-PLAN.md — Install 11ty, configure passthrough copy, create directory data files for URL preservation

**Requirements:**
- SETUP-01: 11ty v3.x installed and configured with Liquid templates
- SETUP-02: Passthrough copy configured for CSS, JS, and image assets
- SETUP-03: All ~412 existing URLs preserved (no broken links)
- SETUP-04: Build completes without errors

**Success Criteria:**
1. Developer can run `npm run build` and 11ty generates site to `_site/` directory
2. All static assets (CSS, JS, images) copy to output without modification
3. Build completes without errors or warnings
4. All ~412 existing URLs accessible at same paths (no 404s)

---

### Phase 36: Components

**Goal:** Shared HTML components extracted as reusable includes.
**Depends on:** Phase 35
**Plans:** 2 plans

Plans:
- [x] 36-01-PLAN.md — Create data files (site, nav, footer) and base layout template
- [x] 36-02-PLAN.md — Extract component includes (header, nav, footer, language-switcher)

**Requirements:**
- COMP-01: Base layout template contains HTML structure (doctype, head, body)
- COMP-02: Header extracted as reusable include
- COMP-03: Footer extracted as reusable include
- COMP-04: Navigation (desktop + mobile) extracted as reusable include
- COMP-05: Language switcher extracted as reusable include

**Success Criteria:**
1. Base layout template renders complete HTML document structure
2. Header displays correctly with logo, navigation, and language switcher
3. Footer displays correctly with same content and styling
4. Navigation works identically to current implementation
5. Language switcher shows IT/EN toggle with same behavior

---

### Phase 37: Pages

**Goal:** All ~410 pages converted to use shared layouts with multilingual output.
**Depends on:** Phase 36
**Plans:** 4 plans

Plans:
- [x] 37-01-PLAN.md — Create migration script, migrate root pages, verify foundation
- [x] 37-02-PLAN.md — Migrate all IT pages (204 pages in src/pages/)
- [x] 37-03-PLAN.md — Migrate all EN pages (204 pages in en/src/pages/)
- [x] 37-04-PLAN.md — Final verification checkpoint for all requirements

**Requirements:**
- PAGE-01: All IT pages (~207) converted to use shared layouts
- PAGE-02: All EN pages (~205) converted to use shared layouts
- PAGE-03: Front matter contains page metadata (title, lang, layout)
- PAGE-04: Page content preserved exactly (no content changes)
- I18N-01: IT pages output to root directory (/)
- I18N-02: EN pages output to /en/ directory
- I18N-03: HTML lang attribute correct for each language

**Success Criteria:**
1. All IT pages render with shared header/footer, content unchanged
2. All EN pages render with shared header/footer, content unchanged
3. Each page has correct metadata in front matter
4. IT pages output to root directory
5. EN pages output to /en/ directory
6. HTML lang attribute matches page language
7. Visual regression check shows no styling differences

---

### Phase 38: Deployment

**Goal:** Site deployed to production on Netlify with fast builds.
**Depends on:** Phase 37
**Plans:** 1 plan

Plans:
- [x] 38-01-PLAN.md — Configure netlify.toml and package.json for combined Notion + 11ty build

**Requirements:**
- DEPLOY-01: netlify.toml configured for 11ty build
- DEPLOY-02: Production deploy successful on Netlify
- DEPLOY-03: Build completes in under 60 seconds

**Success Criteria:**
1. Netlify build command configured in netlify.toml
2. Production deploy completes successfully with no errors
3. Build completes in under 60 seconds
4. All ~412 pages accessible on production domain
5. Notion build scripts continue to work

---

## Milestone Summary

**Key Decisions:**

| Decision | Rationale | Outcome |
|----------|-----------|---------|
| 11ty v3.x over v2.x | Active development, ESM support | Good — v3.1.2 stable |
| Liquid over Nunjucks | Nunjucks unmaintained since June 2022 | Good — Liquid works well |
| Structural migration only | Minimize risk, same content/URLs | Good — no broken links |
| Keep existing Notion scripts | Don't rewrite working integration | Good — combined build works |
| Front matter for metadata | Standard 11ty pattern | Good — clean separation |
| Canonical + hreflang in base | SEO best practice, single source | Good — all pages get tags |

**Issues Resolved:**

- 445 files with duplicated header/footer HTML → single source of truth
- Manual header/footer updates required 400+ file edits → single file change
- No SEO canonical/hreflang tags → automatically added to all pages

**Issues Deferred:**

- Page-specific templates (permit, document, guide) — v3.1
- Navigation as data files — v3.1
- i18n plugin integration — v3.1
- Notion integration rewrite — v3.1

**Technical Debt Incurred:**

- None — clean implementation

---

*For current project status, see .planning/PROJECT.md*
*Archived: 2026-02-05*
