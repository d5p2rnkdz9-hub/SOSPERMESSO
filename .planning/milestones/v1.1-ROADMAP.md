# Milestone v1.1: Documenti Questura

**Status:** ✅ SHIPPED 2026-01-25
**Phases:** 1-3
**Total Plans:** 4

## Overview

Transform documenti-questura page into a comprehensive, scannable resource for all 23 permit types with dedicated first release and renewal document pages. Users find their permit, click primo or rinnovo, and land on a dedicated page with exact document requirements.

## Phases

### Phase 1: Page Foundation

**Goal:** Users can navigate a restructured documenti-questura page with clickable primo/rinnovo badges for every permit type.
**Depends on:** None (uses existing site infrastructure)
**Plans:** 1 plan

Plans:
- [x] 01-01-PLAN.md — Restructure documenti-questura page with category sections and badge navigation

**Requirements:**
- PAGE-01: Documenti-questura uses database.html's category section layout
- PAGE-02: Page displays 4 color-coded categories matching database.html
- PAGE-03: Each permit row shows icon + title + [Primo] + [Rinnovo] badges
- BADGE-01: Primo/Rinnovo badges are clickable, link to respective document pages
- BADGE-02: Badges have distinct styling (compact, visible but not dominant)
- BADGE-03: Badges indicate which document types are available

**Success Criteria:**
1. User opens documenti-questura and sees 4 color-coded category sections
2. User scans permit list and sees inline badges [Primo] [Rinnovo] next to each permit
3. User hovers over a badge and sees clickable hover state
4. User clicks [Primo] badge and navigates to first release document page URL
5. User clicks [Rinnovo] badge and navigates to renewal document page URL

---

### Phase 2: Document Templates

**Goal:** Two complete document page templates (primo rilascio and rinnovo) exist and can be replicated for all permit types.
**Depends on:** Phase 1 (badge links need target pages)
**Plans:** 2 plans

Plans:
- [x] 02-01-PLAN.md — Initialize Node.js build infrastructure with Notion API client
- [x] 02-02-PLAN.md — Create primo/rinnovo templates with checklist, print CSS, localStorage

**Requirements:**
- DOC-01: Create document page template for first release (primo rilascio)
- DOC-02: Create document page template for renewal (rinnovo)
- DOC-04: Document pages follow existing site template (header, breadcrumb, content, footer)

**Success Criteria:**
1. User clicks [Primo] badge and lands on document page with breadcrumb, header, document sections
2. User clicks [Rinnovo] badge and lands on structurally identical page with renewal content
3. User views document page on mobile and sees responsive layout
4. User navigates breadcrumb and returns to correct pages

---

### Phase 3: Complete Coverage

**Goal:** All 23 permit types have working primo and rinnovo document pages (no 404s when clicking badges).
**Depends on:** Phase 2 (templates must exist)
**Plans:** 1 plan

Plans:
- [x] 03-01-PLAN.md — Create slug mapping and redirect pages for complete URL coverage

**Requirements:**
- DOC-03: Each permit gets 2 document pages (primo + rinnovo) — 46 pages total
- COV-01: All 23 permits from database.html represented in documenti-questura
- COV-02: Permits organized in same 4 categories as database.html

**Success Criteria:**
1. User clicks any [Primo] badge and lands on working document page (no 404s)
2. User clicks any [Rinnovo] badge and lands on working document page (no 404s)
3. User counts permit rows and sees all 23 permits present
4. User compares categories between database.html and documenti-questura and sees identical grouping

---

## Milestone Summary

**Key Decisions:**

- Badge URL pattern: documenti-{tipo}-primo.html and documenti-{tipo}-rinnovo.html
- Badge colors: blue gradient for Primo, orange gradient for Rinnovo
- Mobile: badges wrap below permit name with 44x44px min touch targets
- Graceful exit (exit 0) when NOTION_API_KEY not configured
- Database ID as constant in notion-client.js
- Node.js 18 for Netlify build environment
- Partial matching for dizionario links
- Checkbox only triggers on checkbox click, not label text
- Slug mapping via JSON config file
- Meta refresh redirects (0-second delay) for SEO-friendly aliasing
- Common doc "Copia permesso precedente" on all rinnovo pages
- Attesa occupazione disputed warning hardcoded in template

**Issues Resolved:**

- Notion client API v5 method calls updated
- Dizionario term matching changed from exact to partial
- Checkbox triggering on text click fixed
- Broken permit info links removed
- 100% URL coverage achieved with redirect pages

**Technical Debt Incurred:**

- Dizionario links need revision (partial matching works but coverage incomplete)

---

*For current project status, see .planning/ROADMAP.md (created for next milestone)*
