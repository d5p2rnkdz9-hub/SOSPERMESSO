# Milestone v4.0: FR Translation

**Status:** SHIPPED 2026-02-19
**Phases:** 51-54 (+ 53.1 tech debt)
**Total Plans:** 10

## Overview

Add French translation using the same Notion + 11ty pipeline as EN. Extend the translation script to support `--lang fr`, create a French Notion database, generate pages at `/fr/` prefix, and upgrade the language switcher and sitemaps to cover IT/EN/FR. ES translation follows in v4.1 if the FR pipeline works well.

## Phases

### Phase 51: Translation Infrastructure

**Goal:** The translation script can generate French translations of all IT permit and document content, applying a French-specific glossary and section-level hashing to skip unchanged content.
**Depends on:** Phase 47-48 (existing script and cache pattern is the starting point)
**Plans:** 1 plan

Plans:
- [x] 51-01: Multi-language translation script with FR glossary

### Phase 52: Notion Database

**Goal:** A French Notion database exists and contains fully translated permit Q&A content and document data, ready for 11ty to read.
**Depends on:** Phase 51 (translation script must work before running it against Notion)
**Plans:** 1 plan

Plans:
- [x] 52-01: Create FR Notion database and data files

### Phase 53: FR Page Generation

**Goal:** French pages for all permit types, document types, and static sections are generated by 11ty and accessible at `/fr/` prefix, with the language switcher linking IT/EN/FR correctly.
**Depends on:** Phase 52 (FR Notion DB must exist before 11ty can read it)
**Plans:** 3 plans

Plans:
- [x] 53-01: FR pagination templates and pages.11tydata.js
- [x] 53-02: Wire FR language into shared infrastructure (nav, footer, config)
- [x] 53-03: FR static pages (homepage, database, documenti-questura, chi-siamo)

### Phase 53.1: Tech Debt (INSERTED)

**Goal:** Fix 7 accumulated tech debt issues before SEO work: broken sitemap generation, missing permits in listing pages, homepage canonical duplication, missing dizionario links in EN/FR, broken "Scrivici" Typeform button, missing "Contattaci" footer item, and language switcher integration into main nav.
**Depends on:** Phase 53 (FR pages must exist so fixes apply to all three languages)
**Plans:** 5 plans

Plans:
- [x] 53.1-01: Typeform CTA fix, footer contact link, homepage canonical redirects
- [x] 53.1-02: Listing page coverage audit and update (IT/EN/FR)
- [x] 53.1-03: Language switcher integrated into main nav bar
- [x] 53.1-04: 11ty-native sitemap templates (IT/EN/FR + index)
- [x] 53.1-05: Dizionario links expanded with EN/FR term equivalents

### Phase 54: SEO

**Goal:** Search engines can discover all FR pages with correct hreflang cross-references, and the sitemap index includes the FR sitemap.
**Depends on:** Phase 53 (pages must exist before they can be indexed)
**Plans:** Pre-built in phases 53 and 53.1

---

## Milestone Summary

**Decimal Phases:**
- Phase 53.1: Tech Debt (inserted after Phase 53 for accumulated fixes before SEO)

**Key Decisions:**
- FR-only scope (ES deferred to v4.1) — validate pipeline with one language first
- Same pipeline as EN (translate script + Notion DBs + 11ty templates)
- FR DB ID b7955daa hardcoded (not env var), same pattern as EN
- Data-driven sitemaps (Liquid for-loops over data arrays, not collection API)
- Language switcher as nav dropdown with flag emojis, mobile horizontal pills
- Single IT dizionario page as source of truth for all language links
- Footer external links use `external: true` property for target=_blank

**Issues Resolved:**
- Broken sitemap URLs (had `src/pages/` in paths) — replaced with 11ty-native templates
- Missing permits in listing pages (13-14 per language) — full audit and update
- Dead contact modal on permit pages — replaced with direct Typeform link
- Missing footer contact link — added with external link pattern
- Homepage canonical duplication — Netlify 301 redirects
- Language switcher was standalone — integrated into main nav
- Dizionario links missing in EN/FR — expanded term map + language-aware filter

**Issues Deferred:**
- ES translation (v4.1)
- Content validation pass
- 2 permits with no Q&A content (Tirocinio, Lavoro artistico) — IT-only

**Technical Debt Incurred:**
- Old `scripts/build-sitemap.js` preserved but unused (kept for reference)
- `_includes/components/language-switcher.liquid` file exists on disk but not included anywhere

---

_For current project status, see .planning/ROADMAP.md_
